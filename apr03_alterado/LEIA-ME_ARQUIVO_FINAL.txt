â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ARQUIVO FINAL PRONTO PARA IMPORTAR NO WINSUP 2
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ ARQUIVO: apr03_v2_FINAL.sup

Data de criaÃ§Ã£o: 2025-11-10
Baseado em: apr03.sup (programa original da dobradeira)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  âœ… CONFIGURAÃ‡Ã•ES APLICADAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. IHM REMOTA:           FRONTREMOTO=1    âœ… ATIVADA
   â†’ Permite tablet/PC conectar como IHM via RS232/RS485

2. WATCHDOG TIMER:       WATCHDOGTIMER=1  âœ… ATIVO (seguranÃ§a)
   â†’ CLP reseta automaticamente se travar

3. PROTEÃ‡ÃƒO SENHA:       HAB_SENHA=0      âœ… DESATIVADA
   â†’ Sem senha, acesso livre via WinSup 2

4. MODO FORCE:           FORCE=0          âœ… DESATIVADO
   â†’ SeguranÃ§a: nÃ£o permite forÃ§ar I/O em produÃ§Ã£o

5. MODO ESCUTA:          ESCUTA=0         âœ… Como estava
   â†’ Mantido valor original

6. FRONTAL:              FRONTAL=0        âœ… Como estava
   â†’ Mantido valor original

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“‹ SUB-ROTINAS DO PROJETO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… ROT0 - Sub-rotina 0 (lÃ³gica original)
âœ… ROT1 - Sub-rotina 1 (lÃ³gica original)
âœ… ROT2 - Sub-rotina 2 (lÃ³gica original)
âœ… ROT3 - Sub-rotina 3 (lÃ³gica original)
âœ… ROT4 - Sub-rotina 4 (lÃ³gica original)
â­ ROT5 - INTERFACE MODBUS RTU (NOVA!)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  â­ NOVA FUNCIONALIDADE: ROT5 - INTERFACE MODBUS RTU
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

A ROT5 implementa a interface Modbus RTU para comunicaÃ§Ã£o com a IHM web.

CARACTERÃSTICAS:

1. TIMER DE STARTUP (120 segundos)
   - Timer T56 conta 120s apÃ³s power-on
   - Evita ativaÃ§Ã£o prematura do Modbus durante inicializaÃ§Ã£o do CLP
   - Garante que sistema estÃ¡ estÃ¡vel antes de aceitar comandos externos

2. ATIVAÃ‡ÃƒO AUTOMÃTICA DO MODBUS SLAVE
   - ApÃ³s 120s: forÃ§a bit 00BE (190 dec) = ON
   - Bit 00BE habilita modo Modbus Slave no CLP
   - TambÃ©m verifica bit 03FA antes de ativar (seguranÃ§a)

3. COMANDOS VIA MODBUS
   Bits de comando (escritos pelo servidor Python via Modbus):

   â€¢ 03E0 (992)  - MB_BTN_AVANCAR  â†’ emula botÃ£o AVANÃ‡AR (E2)
   â€¢ 03E1 (993)  - MB_BTN_RECUAR   â†’ emula botÃ£o RECUAR (E4)
   â€¢ 03E2 (994)  - MB_BTN_PARADA   â†’ emula botÃ£o PARADA (E3)
   â€¢ 03E3 (995)  - MB_S1_CMD       â†’ emula tecla S1 (mudanÃ§a de modo)
   â€¢ 03E5 (997)  - MB_MODO_AUTO    â†’ forÃ§a modo AUTOMÃTICO
   â€¢ 03E6 (998)  - MB_MODO_MANUAL  â†’ forÃ§a modo MANUAL

4. EMULAÃ‡ÃƒO DE BOTÃ•ES FÃSICOS
   Quando um bit de comando Ã© ativado (ex: 03E0=1):
   - Ativa bit interno 03F1, 03F2 ou 03F3
   - Esse bit aciona a saÃ­da correspondente (E2, E3 ou E4)
   - Simula pressionamento do botÃ£o fÃ­sico
   - LÃ³gica original do CLP responde normalmente

5. DETECÃ‡ÃƒO DE PULSO S1
   - Detecta borda de subida de 03E3 (MB_S1_CMD)
   - Gera pulso em 03F0
   - Usado para mudanÃ§a de modo Manual â†” AutomÃ¡tico

6. MUDANÃ‡A FORÃ‡ADA DE MODO
   MB_MODO_AUTO (03E5):
   - ForÃ§a bit 0191 = ON (modo automÃ¡tico)
   - Reseta bit 0190 = OFF (modo manual)
   - TambÃ©m ativa bits 02FF e 0300 (condiÃ§Ãµes de transiÃ§Ã£o)

   MB_MODO_MANUAL (03E6):
   - ForÃ§a bit 0190 = ON (modo manual)
   - Reseta bit 0191 = OFF (modo automÃ¡tico)
   - Ativa bit 02FF (condiÃ§Ã£o de transiÃ§Ã£o)

7. AUTO-RESET DE COMANDOS
   - Linha 11 reseta automaticamente bits 03E5 e 03E6
   - ApÃ³s execuÃ§Ã£o, comandos voltam a 0
   - Evita comandos "travados"

8. STATUS DA INTERFACE
   - Bit 03FF = ON quando:
     â€¢ Modbus ativo (00BE=ON)
     â€¢ Sistema nÃ£o em emergÃªncia (02FF=ON)
   - Pode ser lido pela IHM para verificar conexÃ£o

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ”§ CONFIGURAÃ‡ÃƒO MODBUS RTU NO CLP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Canal: RS485-B (porta lateral do CLP)
Baudrate: 57600 bps
Paridade: None
Data bits: 8
Stop bits: 1
Slave Address: Lido do registro 1988H (6536 dec) - verificar no CLP

Bit de habilitaÃ§Ã£o: 00BE (190 dec) - DEVE estar ON (ativado por ROT5)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“‚ ARQUIVOS DE BACKUP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… apr03_v2_alterado_BACKUP_ORIGINAL.sup
   â†’ CÃ³pia de seguranÃ§a antes da modificaÃ§Ã£o FRONTREMOTO

âœ… apr03_v2_alterado.bak
   â†’ Backup automÃ¡tico do WinSup

âœ… apr03_v2_alterado.sup
   â†’ VersÃ£o anterior (sem FRONTREMOTO ativado)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸš€ COMO USAR NO WINSUP 2
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Abra o WinSup 2

2. VÃ¡ em: Arquivo â†’ Abrir Projeto

3. Selecione: apr03_v2_FINAL.sup

4. O WinSup deve abrir o projeto mostrando:
   - Programa Principal
   - ROT0, ROT1, ROT2, ROT3, ROT4, ROT5

5. Compile o projeto (F7 ou Compilar â†’ Compilar Projeto)

6. Verifique se nÃ£o hÃ¡ erros de compilaÃ§Ã£o

7. Transfira para o CLP:
   - Conecte cabo USB-RS485 ao canal A do CLP
   - Online â†’ Enviar Programa
   - Aguarde transferÃªncia completa

8. ApÃ³s gravaÃ§Ã£o:
   - CLP vai reiniciar automaticamente
   - Timer de 120s comeÃ§a a contar
   - ApÃ³s 120s: bit 00BE Ã© ativado
   - Modbus RTU fica disponÃ­vel no canal B

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  âš ï¸ VERIFICAÃ‡Ã•ES IMPORTANTES APÃ“S GRAVAR NO CLP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. VERIFICAR BIT 00BE (Modbus Slave)
   - ApÃ³s 120s do power-on, verificar se bit 00BE = ON
   - Se OFF: verificar lÃ³gica da ROT5

2. VERIFICAR ENDEREÃ‡O MODBUS
   - Ler registro 1988H (6536 dec)
   - Anotar o Slave Address (provavelmente 1)

3. TESTAR COMUNICAÃ‡ÃƒO MODBUS
   - Conectar conversor USB-RS485 ao canal B
   - Usar software de teste Modbus (ex: Modbus Poll)
   - Tentar ler registro 0100 (entrada E0)
   - Deve responder se configuraÃ§Ã£o estiver OK

4. TESTAR COMANDOS VIA MODBUS
   - Escrever bit 03E0 = 1 (comando AVANÃ‡AR)
   - Verificar se saÃ­da E2 ativa
   - Escrever bit 03E0 = 0
   - Verificar se saÃ­da E2 desativa

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“Š MAPEAMENTO DE BITS PARA SERVIDOR PYTHON
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

COMANDOS (escrever via Modbus Function 0x05 - Force Single Coil):

  Decimal | Hex  | Nome               | FunÃ§Ã£o
  --------|------|--------------------|---------------------------------
  992     | 03E0 | MB_BTN_AVANCAR     | BotÃ£o AVANÃ‡AR (CCW)
  993     | 03E1 | MB_BTN_RECUAR      | BotÃ£o RECUAR (CW)
  994     | 03E2 | MB_BTN_PARADA      | BotÃ£o PARADA
  995     | 03E3 | MB_S1_CMD          | Tecla S1 (mudanÃ§a modo)
  997     | 03E5 | MB_MODO_AUTO       | ForÃ§a modo AUTOMÃTICO
  998     | 03E6 | MB_MODO_MANUAL     | ForÃ§a modo MANUAL

STATUS (ler via Modbus Function 0x01 - Read Coil Status):

  Decimal | Hex  | Nome               | Significado
  --------|------|--------------------|---------------------------------
  190     | 00BE | MODBUS_SLAVE_ON    | Modbus ativo (deve ser 1)
  256-263 | 0100 | E0-E7              | Entradas digitais
  384-391 | 0180 | S0-S7              | SaÃ­das digitais
  1023    | 03FF | INTERFACE_OK       | Interface Modbus OK

REGISTROS (ler via Modbus Function 0x03 - Read Holding Registers):

  Decimal     | Hex      | Nome            | Tipo
  ------------|----------|-----------------|---------------------------
  1238/1239   | 04D6/D7  | ENCODER_VALUE   | 32-bit (MSW/LSW)
  256-263     | 0100-107 | E0-E7 STATUS    | 16-bit (bit 0 = status)
  384-391     | 0180-187 | S0-S7 STATUS    | 16-bit (bit 0 = status)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“ NOTAS TÃ‰CNICAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Timer T56 usa preset 0438H (1080 dec) com valor 12000
   - 12000 Ã— 10ms = 120.000ms = 120 segundos
   - AjustÃ¡vel se necessÃ¡rio

2. Bits 03F1, 03F2, 03F3 sÃ£o internos de emulaÃ§Ã£o
   - NÃ£o devem ser escritos diretamente pela IHM
   - Apenas leitura para debug

3. ComunicaÃ§Ã£o bidirecional:
   - IHM â†’ CLP: comandos via bits (Write Coil)
   - CLP â†’ IHM: status via leitura (Read Coil/Register)

4. Estados importantes da mÃ¡quina (a serem mapeados):
   - 0190: Modo MANUAL ativo
   - 0191: Modo AUTOMÃTICO ativo
   - 02FF: Sistema nÃ£o em emergÃªncia
   - Ver programa original para mapear outros bits

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  âœ… CHECKLIST PRE-OPERAÃ‡ÃƒO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–¡ Arquivo apr03_v2_FINAL.sup aberto no WinSup 2
â–¡ Projeto compilado sem erros
â–¡ Backup do programa atual do CLP feito
â–¡ Programa transferido para o CLP
â–¡ CLP reiniciado apÃ³s gravaÃ§Ã£o
â–¡ Aguardado 120 segundos para ativaÃ§Ã£o Modbus
â–¡ Bit 00BE verificado = ON
â–¡ Slave Address lido do registro 1988H
â–¡ ComunicaÃ§Ã£o Modbus testada com software de teste
â–¡ Servidor Python configurado com endereÃ§os corretos
â–¡ Teste de comando bÃ¡sico OK (ex: acionar AVANÃ‡AR)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ†˜ SUPORTE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Em caso de problemas:

1. MODBUS NÃƒO RESPONDE
   - Verificar bit 00BE = ON (apÃ³s 120s)
   - Verificar cabo RS485 no canal B
   - Verificar baudrate 57600
   - Verificar Slave Address correto

2. COMANDOS NÃƒO FUNCIONAM
   - Verificar se sistema nÃ£o estÃ¡ em emergÃªncia (bit 02FF)
   - Verificar modo de operaÃ§Ã£o (manual/auto)
   - Ver lÃ³gica original que processa os botÃµes

3. RESTAURAR PROGRAMA ANTERIOR
   - Abrir backup: apr03_v2_alterado_BACKUP_ORIGINAL.sup
   - Recompilar e transferir

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Arquivo preparado para importaÃ§Ã£o no WinSup 2 e gravaÃ§Ã£o no CLP ATOS MPC4004.

Data: 2025-11-10
Projeto: IHM Web para Dobradeira NEOCOUDE-HD-15

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
